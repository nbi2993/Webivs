<div id="fab-container-wrapper">
    <div id="fab-buttons-container" class="fixed right-4 z-30 flex flex-col items-end space-y-3 bottom-20 md:bottom-4">
        <button id="scroll-to-top-btn" title="Lên đầu trang" aria-label="Lên đầu trang"
                class="fab-item flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 bg-neutral-600 dark:bg-neutral-700 text-white rounded-full shadow-lg hover:bg-neutral-700 dark:hover:bg-neutral-600 transition-all duration-300 ease-out transform active:scale-90 opacity-0 scale-90 pointer-events-none">
            <i class="fas fa-arrow-up text-base sm:text-lg"></i>
        </button>
        <div class="relative group/fab">
            <button id="share-main-btn" title="Chia sẻ" aria-label="Mở menu chia sẻ" aria-haspopup="true" aria-expanded="false" aria-controls="share-options"
                    class="fab-item flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full shadow-xl transition-transform duration-200 transform hover:scale-110 active:scale-95">
                <i class="fas fa-share-alt text-xl sm:text-2xl"></i>
            </button>
            <div id="share-options" class="fab-submenu-panel" role="menu"></div>
        </div>
        <div class="relative group/fab">
            <button id="contact-main-btn" title="Liên hệ" aria-label="Mở menu liên hệ" aria-haspopup="true" aria-expanded="false" aria-controls="contact-options"
                    class="fab-item flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-xl transition-transform duration-200 transform hover:scale-110 active:scale-95">
                <i class="fas fa-comment-dots text-xl sm:text-2xl"></i>
            </button>
            <div id="contact-options" class="fab-submenu-panel" role="menu"></div>
        </div>
        <button id="chatbot-open-button" title="Mở Chatbot AI" aria-label="Mở Chatbot AI"
                class="fab-item flex items-center justify-center w-12 h-12 sm:w-14 sm:h-14 bg-purple-600 hover:bg-purple-700 text-white rounded-full shadow-xl transition-transform duration-200 transform hover:scale-110 active:scale-95">
            <i class="fas fa-robot text-xl sm:text-2xl"></i>
        </button>
    </div>

    <div id="chatbot-container" class="fixed bottom-4 right-4 md:right-6 bg-ivs-card border border-ivs-border rounded-2xl shadow-2xl flex flex-col overflow-hidden transition-all duration-300 ease-in-out z-40 transform scale-0 opacity-0 origin-bottom-right" style="width: calc(100% - 32px); max-width: 400px; height: calc(100% - 100px); max-height: 600px; display: none;">
        <header class="flex items-center justify-between p-3 border-b border-ivs-border flex-shrink-0">
            <div class="flex items-center">
                <img src="/images/logo/logo-192.png" alt="IVS Bot" class="w-10 h-10 rounded-full mr-3">
                <div>
                    <h3 class="font-bold text-white text-base">IVS AI Assistant</h3>
                    <p class="text-xs text-ivs-green">● Online</p>
                </div>
            </div>
            <button id="chatbot-close-button" class="text-ivs-text-secondary hover:text-white text-2xl" aria-label="Đóng Chatbot">&times;</button>
        </header>
        <div id="chatbot-messages" class="flex-1 p-4 overflow-y-auto"></div>
        <footer class="p-3 border-t border-ivs-border bg-ivs-bg flex-shrink-0">
            <div class="flex items-center bg-ivs-bg border border-ivs-border rounded-lg">
                <input type="text" id="chatbot-input" placeholder="Type your message..." class="flex-1 bg-transparent px-4 py-2 text-white focus:outline-none">
                <button id="chatbot-send-button" class="p-3 text-ivs-blue hover:text-white transition-colors" aria-label="Gửi tin nhắn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </footer>
    </div>
</div>

<style>
    .fab-submenu-panel {
        position: absolute; bottom: 100%; right: 0; margin-bottom: 0.5rem; padding: 0.5rem;
        background-color: #161B22; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        border: 1px solid #30363d; display: flex; flex-direction: column; gap: 0.25rem;
        transition: all 0.2s ease-out; opacity: 0; transform: scale(0.95) translateY(10px); pointer-events: none;
    }
    .fab-submenu-panel.active {
        opacity: 1; transform: scale(1) translateY(0); pointer-events: auto;
    }
    .fab-submenu-item {
        display: flex; align-items: center; padding: 0.5rem 1rem; font-size: 0.9rem;
        color: #c9d1d9; border-radius: 0.375rem; transition: background-color 0.2s; white-space: nowrap;
    }
    .fab-submenu-item:hover { background-color: #30363d; }
    .fab-submenu-item i { margin-right: 0.75rem; width: 1.25rem; text-align: center; }
    #chatbot-messages { scrollbar-width: thin; scrollbar-color: #30363d #161B22; }
    #chatbot-messages::-webkit-scrollbar { width: 6px; }
    #chatbot-messages::-webkit-scrollbar-thumb { background-color: #30363d; border-radius: 3px; }
    .typing-indicator span {
        height: 8px; width: 8px; margin: 0 1px; background-color: #9ca3af;
        border-radius: 50%; display: inline-block;
        animation: ivs-bounce 1.4s infinite ease-in-out both;
    }
    .typing-indicator span:nth-of-type(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-of-type(2) { animation-delay: -0.16s; }
    @keyframes ivs-bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1.0); }
    }
</style>

<script src="/js/fab-controller.js" defer></script>